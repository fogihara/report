graph TD
    A[Truncate table in CCSDATA - C21_420 - 1-1-01] --> B;
    B[Upload XNPUSID from ORDERDESK to CCSDATA - C21_200 - 1-3-02] --> C;
    C[Gen CSVName - 110-030] -->|If @[User::varRecordCount] > 0| D;
    D[Create CSV file - 100-040] --> E;
    E[Upload FTP file - 100-050] --> F;
    F[Move dat file into Processed folder - 100-060] --> G;
    G[Add Log BWPFLELH - C21_200 - 1-4-03];

    subgraph Error Handler
        H[OnError Event]
        H --> I[Send Mail Task];
    end

    style A fill:#f9f,stroke:#333
    style B fill:#fcc,stroke:#333
    style C fill:#f9f,stroke:#333
    style D fill:#fcc,stroke:#333
    style E fill:#ccf,stroke:#333
    style F fill:#f9f,stroke:#333
    style G fill:#f9f,stroke:#333
